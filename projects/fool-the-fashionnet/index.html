<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> Fool the FashionNet! | Team T. Team </title> <meta name="author" content="Team T. Team"> <meta name="description" content="200 points"> <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website"> <link rel="stylesheet" href="/govtech-25-ctf-writeup/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="/govtech-25-ctf-writeup/assets/libs/mdb/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/govtech-25-ctf-writeup/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" href="/govtech-25-ctf-writeup/assets/css/scholar-icons.css?62b2ac103a88034e6882a5be5f3e2772"> <link defer rel="stylesheet" type="text/css" href="/govtech-25-ctf-writeup/assets/libs/google_fonts/google-fonts.css"> <link defer rel="stylesheet" href="/govtech-25-ctf-writeup/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="/govtech-25-ctf-writeup/assets/img/team-team-logo.png?515ee9a93529f322a89c3b07c0a510dc"> <link rel="stylesheet" href="/govtech-25-ctf-writeup/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://cakiki.github.io/govtech-25-ctf-writeup/projects/fool-the-fashionnet/"> <script src="/govtech-25-ctf-writeup/assets/js/theme.js?a81d82887dd692e91686b43de4542f18"></script> <link defer rel="stylesheet" href="/govtech-25-ctf-writeup/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script>
    initTheme();
  </script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/govtech-25-ctf-writeup/"> <span class="font-weight-bold">Team</span> T. Team </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/govtech-25-ctf-writeup/">Home </a> </li> <li class="nav-item "> <a class="nav-link" href="/govtech-25-ctf-writeup/writeups/">Writeups </a> </li> <li class="nav-item "> <a class="nav-link" href="/govtech-25-ctf-writeup/team/">Team </a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="ti ti-sun-moon" id="light-toggle-system"></i> <i class="ti ti-moon-filled" id="light-toggle-dark"></i> <i class="ti ti-sun-filled" id="light-toggle-light"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <div class="post"> <header class="post-header"> <h1 class="post-title">Fool the FashionNet!</h1> <p class="post-description">200 points</p> </header> <article> <blockquote class="block-tip"> <h4 id="challenge">Challenge</h4> <p>Your greatest rival, FashionNET, has unveiled a state-of-the-art AI that “perfectly” organises wardrobes for millions-until someone left the model weights exposed on a public server. Now their classifier is laughably fragile: tiny, invisible tweaks can flip shirts into shoes, or trousers into dresses. As a trained AI hacker, craft a near-invisible perturbation, and prove you can outstyle their system. Steal the spotlight - and claim the flag.</p> <p>Your mission: Craft a tiny delta.npy that flips FashionNET’s AI model prediction, without changing how the image looks to humans. Respect the L-infinity and SSIM rules-stay stealthy, no wild makeovers! Submit to verify and claim the flag. Can you outsmart the AI (and look good doing it)? Bonus points for style, zero points for pixelated chaos.</p> </blockquote> <h4 id="solution">Solution</h4> <p>We run a simple PGD attack until we flip the label predicted by the model, ensuring our image delta is always clamped between -0.08/+0.08.</p> <figure class="highlight"><pre><code class="language-python" data-lang="python"><table class="rouge-table"><tbody><tr>
<td class="gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
</pre></td> <td class="code"><pre><span class="kn">import</span> <span class="n">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">import</span> <span class="n">random</span>
<span class="kn">import</span> <span class="n">torch</span>
<span class="kn">import</span> <span class="n">torch.nn.functional</span> <span class="k">as</span> <span class="n">F</span>
<span class="kn">import</span> <span class="n">warnings</span>
<span class="kn">from</span> <span class="n">PIL</span> <span class="kn">import</span> <span class="n">Image</span>
<span class="kn">from</span> <span class="n">torchvision</span> <span class="kn">import</span> <span class="n">transforms</span>

<span class="n">warnings</span><span class="p">.</span><span class="nf">filterwarnings</span><span class="p">(</span><span class="sh">"</span><span class="s">ignore</span><span class="sh">"</span><span class="p">)</span>

<span class="kn">from</span> <span class="n">model</span> <span class="kn">import</span> <span class="n">SmallFashionCNN</span>
<span class="kn">from</span> <span class="n">utils</span> <span class="kn">import</span> <span class="n">linf</span><span class="p">,</span> <span class="n">ssim_01</span>

<span class="n">PATH_MODEL</span> <span class="o">=</span> <span class="sh">"</span><span class="s">./model.pt</span><span class="sh">"</span>
<span class="n">PATH_BASE</span> <span class="o">=</span> <span class="sh">"</span><span class="s">./seed.png</span><span class="sh">"</span>
<span class="n">DEVICE</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="nf">device</span><span class="p">(</span><span class="sh">"</span><span class="s">cuda</span><span class="sh">"</span><span class="p">)</span>

<span class="n">SEED</span> <span class="o">=</span> <span class="mi">1337</span>
<span class="n">EPS</span> <span class="o">=</span> <span class="mf">0.08</span>
<span class="n">LR</span> <span class="o">=</span> <span class="mf">0.01</span>
<span class="n">N_ITERS</span> <span class="o">=</span> <span class="mi">100</span>

<span class="k">def</span> <span class="nf">attack</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="n">delta</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="nf">zeros_like</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">requires_grad</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="n">N_ITERS</span><span class="p">):</span>
        <span class="n">outputs</span> <span class="o">=</span> <span class="nf">model</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">delta</span><span class="p">)</span>
        <span class="n">loss</span> <span class="o">=</span> <span class="n">F</span><span class="p">.</span><span class="nf">cross_entropy</span><span class="p">(</span><span class="n">outputs</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
        <span class="n">loss</span><span class="p">.</span><span class="nf">backward</span><span class="p">()</span>
        <span class="k">with</span> <span class="n">torch</span><span class="p">.</span><span class="nf">no_grad</span><span class="p">():</span>
            <span class="n">delta</span> <span class="o">+=</span> <span class="n">LR</span> <span class="o">*</span> <span class="n">torch</span><span class="p">.</span><span class="nf">sign</span><span class="p">(</span><span class="n">delta</span><span class="p">.</span><span class="n">grad</span><span class="p">)</span>
            <span class="n">delta</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="nf">clamp</span><span class="p">(</span><span class="n">delta</span><span class="p">,</span> <span class="o">-</span><span class="n">EPS</span><span class="p">,</span> <span class="n">EPS</span><span class="p">)</span>
            <span class="n">delta</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="nf">clamp</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">delta</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="n">x</span>
        <span class="n">delta</span><span class="p">.</span><span class="n">requires_grad</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="n">model</span><span class="p">.</span><span class="nf">zero_grad</span><span class="p">()</span>
        <span class="k">with</span> <span class="n">torch</span><span class="p">.</span><span class="nf">no_grad</span><span class="p">():</span>
            <span class="k">if</span> <span class="nf">model</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">delta</span><span class="p">).</span><span class="nf">argmax</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">!=</span> <span class="n">y</span><span class="p">:</span>
                <span class="k">break</span>
    <span class="k">return</span> <span class="n">delta</span><span class="p">.</span><span class="nf">detach</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">solve</span><span class="p">():</span>
    <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="nf">seed</span><span class="p">(</span><span class="n">SEED</span><span class="p">)</span>
    <span class="n">random</span><span class="p">.</span><span class="nf">seed</span><span class="p">(</span><span class="n">SEED</span><span class="p">)</span>
    <span class="n">torch</span><span class="p">.</span><span class="nf">manual_seed</span><span class="p">(</span><span class="n">SEED</span><span class="p">)</span>
    
    <span class="n">model</span> <span class="o">=</span> <span class="nc">SmallFashionCNN</span><span class="p">().</span><span class="nf">to</span><span class="p">(</span><span class="n">DEVICE</span><span class="p">)</span>
    <span class="n">state_dict</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="nf">load</span><span class="p">(</span><span class="n">PATH_MODEL</span><span class="p">,</span> <span class="n">map_location</span><span class="o">=</span><span class="n">DEVICE</span><span class="p">)[</span><span class="sh">"</span><span class="s">model_state</span><span class="sh">"</span><span class="p">]</span>
    <span class="n">model</span><span class="p">.</span><span class="nf">load_state_dict</span><span class="p">(</span><span class="n">state_dict</span><span class="p">,</span> <span class="n">strict</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">model</span><span class="p">.</span><span class="nf">eval</span><span class="p">()</span>

    <span class="n">img</span> <span class="o">=</span> <span class="n">Image</span><span class="p">.</span><span class="nf">open</span><span class="p">(</span><span class="n">PATH_BASE</span><span class="p">).</span><span class="nf">convert</span><span class="p">(</span><span class="sh">"</span><span class="s">L</span><span class="sh">"</span><span class="p">).</span><span class="nf">resize</span><span class="p">((</span><span class="mi">28</span><span class="p">,</span> <span class="mi">28</span><span class="p">))</span>
    <span class="n">tt</span> <span class="o">=</span> <span class="n">transforms</span><span class="p">.</span><span class="nc">ToTensor</span><span class="p">()</span>
    <span class="n">orig</span> <span class="o">=</span> <span class="nf">tt</span><span class="p">(</span><span class="n">img</span><span class="p">).</span><span class="nf">unsqueeze</span><span class="p">(</span><span class="mi">0</span><span class="p">).</span><span class="nf">to</span><span class="p">(</span><span class="n">DEVICE</span><span class="p">)</span>

    <span class="k">with</span> <span class="n">torch</span><span class="p">.</span><span class="nf">no_grad</span><span class="p">():</span>
        <span class="n">orig_label</span> <span class="o">=</span> <span class="nf">model</span><span class="p">(</span><span class="n">orig</span><span class="p">).</span><span class="nf">argmax</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="n">delta</span> <span class="o">=</span> <span class="nf">attack</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">orig</span><span class="p">,</span> <span class="n">orig_label</span><span class="p">)</span>
    <span class="n">adv</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="nf">clamp</span><span class="p">(</span><span class="n">orig</span> <span class="o">+</span> <span class="n">delta</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>

    <span class="k">with</span> <span class="n">torch</span><span class="p">.</span><span class="nf">no_grad</span><span class="p">():</span>
        <span class="n">adv_label</span> <span class="o">=</span> <span class="nf">model</span><span class="p">(</span><span class="n">adv</span><span class="p">).</span><span class="nf">argmax</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="si">{</span><span class="nf">int</span><span class="p">(</span><span class="n">orig_label</span><span class="p">)</span><span class="si">}</span><span class="s"> -&gt; </span><span class="si">{</span><span class="nf">int</span><span class="p">(</span><span class="n">adv_label</span><span class="p">)</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>

    <span class="n">orig_np</span> <span class="o">=</span> <span class="n">orig</span><span class="p">.</span><span class="nf">cpu</span><span class="p">().</span><span class="nf">numpy</span><span class="p">().</span><span class="nf">astype</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="n">float32</span><span class="p">)</span>
    <span class="n">adv_np</span> <span class="o">=</span> <span class="n">adv</span><span class="p">.</span><span class="nf">cpu</span><span class="p">().</span><span class="nf">numpy</span><span class="p">().</span><span class="nf">astype</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="n">float32</span><span class="p">)</span>
    <span class="n">delta_np</span> <span class="o">=</span> <span class="n">delta</span><span class="p">.</span><span class="nf">cpu</span><span class="p">().</span><span class="nf">numpy</span><span class="p">().</span><span class="nf">astype</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="n">float32</span><span class="p">)</span>

    <span class="n">orig_2d</span> <span class="o">=</span> <span class="n">orig_np</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,:,:]</span>
    <span class="n">adv_2d</span> <span class="o">=</span> <span class="n">adv_np</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,:,:]</span>

    <span class="n">delta_linf</span> <span class="o">=</span> <span class="n">delta_np</span><span class="p">.</span><span class="nf">reshape</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span> <span class="mi">28</span><span class="p">))</span>
    <span class="n">metric_linf_mn</span><span class="p">,</span> <span class="n">metric_linf_valid</span> <span class="o">=</span> <span class="nf">linf</span><span class="p">(</span><span class="n">delta_linf</span><span class="p">,</span> <span class="n">eps</span><span class="o">=</span><span class="n">EPS</span><span class="p">)</span>
    <span class="n">metric_ssim</span> <span class="o">=</span> <span class="nf">ssim_01</span><span class="p">(</span><span class="n">orig_2d</span><span class="p">,</span> <span class="n">adv_2d</span><span class="p">)</span>
    <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="si">{</span><span class="n">metric_ssim</span><span class="o">=</span><span class="si">:</span><span class="mi">6</span><span class="n">f</span><span class="si">}</span><span class="s"> </span><span class="si">{</span><span class="n">metric_linf_mn</span><span class="o">=</span><span class="si">:</span><span class="mi">6</span><span class="n">f</span><span class="si">}</span><span class="s"> </span><span class="si">{</span><span class="n">metric_linf_valid</span><span class="o">=</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>

    <span class="k">if</span> <span class="nf">int</span><span class="p">(</span><span class="n">orig_label</span><span class="p">)</span> <span class="o">!=</span> <span class="nf">int</span><span class="p">(</span><span class="n">adv_label</span><span class="p">)</span> <span class="ow">and</span> <span class="n">metric_linf_valid</span> <span class="ow">and</span> <span class="n">metric_ssim</span> <span class="o">&gt;=</span> <span class="mf">0.85</span><span class="p">:</span>
        <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">valid</span><span class="sh">"</span><span class="p">)</span>
        <span class="n">np</span><span class="p">.</span><span class="nf">save</span><span class="p">(</span><span class="sh">"</span><span class="s">delta.npy</span><span class="sh">"</span><span class="p">,</span> <span class="n">delta_linf</span><span class="p">.</span><span class="nf">astype</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="n">float32</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">invalid</span><span class="sh">"</span><span class="p">)</span>

<span class="nf">solve</span><span class="p">()</span>
</pre></td> </tr></tbody></table></code></pre></figure> <figure> <picture> <source class="responsive-img-srcset" srcset="/govtech-25-ctf-writeup/assets/img/fashionnet-480.webp 480w,/govtech-25-ctf-writeup/assets/img/fashionnet-800.webp 800w,/govtech-25-ctf-writeup/assets/img/fashionnet-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/govtech-25-ctf-writeup/assets/img/fashionnet.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" data-zoomable="" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </article> </div> </div> <footer class="fixed-bottom" role="contentinfo"> <div class="container mt-0"> © Copyright 2025 Team T. Team. Using <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a>. </div> </footer> <script src="/govtech-25-ctf-writeup/assets/libs/jquery/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/govtech-25-ctf-writeup/assets/js/bootstrap.bundle.min.js"></script> <script src="/govtech-25-ctf-writeup/assets/libs/mdb/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="/govtech-25-ctf-writeup/assets/libs/masonry/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="/govtech-25-ctf-writeup/assets/libs/imagesloaded/imagesloaded.pkgd.min.js" integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin="anonymous"></script> <script defer src="/govtech-25-ctf-writeup/assets/js/masonry.js?a0db7e5d5c70cc3252b3138b0c91dcaf" type="text/javascript"></script> <script defer src="/govtech-25-ctf-writeup/assets/libs/medium_zoom/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/govtech-25-ctf-writeup/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script src="/govtech-25-ctf-writeup/assets/js/no_defer.js?2781658a0a2b13ed609542042a859126"></script> <script defer src="/govtech-25-ctf-writeup/assets/js/common.js?e0514a05c5c95ac1a93a8dfd5249b92e"></script> <script defer src="/govtech-25-ctf-writeup/assets/js/copy_code.js?c8a01c11a92744d44b093fc3bda915df" type="text/javascript"></script> <script defer src="/govtech-25-ctf-writeup/assets/js/jupyter_new_tab.js?d9f17b6adc2311cbabd747f4538bb15f"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script defer type="text/javascript" id="MathJax-script" src="/govtech-25-ctf-writeup/assets/libs/mathjax/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script> <script src="/govtech-25-ctf-writeup/assets/js/mathjax-setup.js?a5bb4e6a542c546dd929b24b8b236dfd"></script> <script defer src="/govtech-25-ctf-writeup/assets/libs/polyfill/polyfill.min.js" crossorigin="anonymous"></script> <script defer src="/govtech-25-ctf-writeup/assets/js/progress-bar.js?2f30e0e6801ea8f5036fa66e1ab0a71a" type="text/javascript"></script> <script src="/govtech-25-ctf-writeup/assets/js/vanilla-back-to-top.min.js?f40d453793ff4f64e238e420181a1d17"></script> <script>
    addBackToTop();
  </script> </body> </html>